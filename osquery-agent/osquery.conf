{
  "options": {
    "config_plugin": "filesystem",
    "logger_plugin": "filesystem,tls",
    "logger_path": "C:\\ProgramData\\osquery\\logs",
    "disable_database": "true",
    "schedule_splay_percent": "10",
    "pidfile": "C:\\ProgramData\\osquery\\osqueryd.pidfile",
    "events_expiry": "3600",
    "database_path": "C:\\ProgramData\\osquery\\osquery.db",
    "verbose": "false",
    "worker_threads": "2",
    "enable_monitor": "true"
  },
  "schedule": {
    "geolocation": {
      "query": "SELECT latitude, longitude, altitude, accuracy FROM geolocation;",
      "interval": 300,
      "description": "Get device GPS location every 5 minutes"
    },
    "installed_programs": {
      "query": "SELECT name, version, install_location, install_date FROM programs WHERE install_location IS NOT NULL;",
      "interval": 3600,
      "description": "Get installed programs hourly"
    },
    "browser_history": {
      "query": "SELECT url, visit_count, last_visit_time FROM browser_history WHERE url IS NOT NULL ORDER BY last_visit_time DESC LIMIT 100;",
      "interval": 600,
      "description": "Get browser history every 10 minutes"
    },
    "system_info": {
      "query": "SELECT hostname, computer_name, hardware_model, hardware_serial, cpu_brand, physical_memory FROM system_info;",
      "interval": 300,
      "description": "Get system information every 5 minutes (heartbeat for last_seen)"
    },
    "heartbeat": {
      "query": "SELECT 1 as heartbeat FROM system_info;",
      "interval": 300,
      "description": "Heartbeat query to update last_seen every 5 minutes even without GPS"
    }
  },
  "decorators": {
    "load": [
      "SELECT uuid AS host_uuid FROM system_info;",
      "SELECT hostname FROM system_info;"
    ]
  },
  "packs": {},
  "file_paths": {
    "windows_programs": [
      "C:\\Program Files\\%",
      "C:\\Program Files (x86)\\%",
      "C:\\ProgramData\\%"
    ]
  }
}
